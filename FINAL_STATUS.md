# –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞ Suefabot

## ‚úÖ –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è (P0) - –í–°–ï –í–´–ü–û–õ–ù–ï–ù–´ ‚úÖ

1. **‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram WebApp initData**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `backend/auth.py`
   - HMAC –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
   - JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Å–µ—Å—Å–∏–π

2. **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ —Å winner_id**
   - –¢–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è: `winner_id`, `winner_telegram_id`, `winner_num`
   - –§—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ

3. **‚úÖ Promise –≤ –æ—Ç–≤–µ—Ç–µ –º–∞—Ç—á–∞**
   - –ü–æ–ª–µ `promise` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

4. **‚úÖ Race condition –ø—Ä–∏ join**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `with_for_update()` –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –¥–≤—É–º –∏–≥—Ä–æ–∫–∞–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

5. **‚úÖ –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TTL –º–∞—Ç—á–∞**
   - TTL –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–±–æ—Ä–µ

6. **‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤**
   - –°–æ–∑–¥–∞–Ω `timeout_worker.py`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç —Å—Ç–∞–≤–æ–∫
   - –û—á–∏—Å—Ç–∫–∞ Redis

7. **‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**
   - `TransactionService` –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –ö–æ–º–∏—Å—Å–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å—á–µ—Ç
   - –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

8. **‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**
   - –û—Å—Ç–∞–≤–ª–µ–Ω —Ç–æ–ª—å–∫–æ —Ç—Ä–∏–≥–≥–µ—Ä –ë–î

9. **‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ**
   - –¢–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã

10. **‚úÖ Rate limiting**
    - Middleware –¥–ª—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è (P1) - –í–°–ï –í–´–ü–û–õ–ù–ï–ù–´ ‚úÖ

1. **‚úÖ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
   - `docker-compose.yml` –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
   - –û—Ç–¥–µ–ª—å–Ω—ã–µ Dockerfile
   - Health checks

2. **‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - Unit —Ç–µ—Å—Ç—ã –¥–ª—è GameLogic (100% –ø–æ–∫—Ä—ã—Ç–∏–µ)
   - Integration —Ç–µ—Å—Ç—ã –¥–ª—è match flow

3. **‚úÖ JWT –¥–ª—è WebSocket**
   - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

4. **‚úÖ Alembic –º–∏–≥—Ä–∞—Ü–∏–∏**
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
   - `migrations/env.py`

5. **‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–æ—Ç–∞ —Å backend**
   - API client –≤ –±–æ—Ç–µ
   - –†–µ–∞–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–µ–π —á–µ—Ä–µ–∑ inline
   - –ü—Ä–æ—Ñ–∏–ª—å –∏–∑ backend

### –£–ª—É—á—à–µ–Ω–∏—è (P2) - –ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–´ ‚úÖ

1. **‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - Prometheus –º–µ—Ç—Ä–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
   - Endpoint `/metrics`
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

2. **‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –∫–æ–º–∏—Å—Å–∏–π**
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
   - –í—Å–µ –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ SYSTEM —Å—á–µ—Ç

3. **‚ùå FastAPI** - –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (–æ—Å—Ç–∞–ª—Å—è Flask)
4. **‚ùå Sentry** - –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ üéâ

1. **‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏**
   - CSS –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
   - –≠—Ñ—Ñ–µ–∫—Ç—ã –ø–æ–±–µ–¥—ã/–ø–æ—Ä–∞–∂–µ–Ω–∏—è
   - –ê–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ª—É—Ç–±–æ–∫—Å–æ–≤

2. **‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–Ω–æ–≤**
   - 10+ –±–∞–∑–æ–≤—ã—Ö —Å–∫–∏–Ω–æ–≤
   - –†–∞–∑–Ω—ã–µ —Ä–µ–¥–∫–æ—Å—Ç–∏ (common, rare, epic, legendary)
   - –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

3. **‚úÖ –õ—É—Ç–±–æ–∫—Å—ã**
   - –ú–µ—Ö–∞–Ω–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Å—É–Ω–¥—É–∫
   - API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

4. **‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
   - Makefile –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - .env.example
   - –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î

## –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ production! üöÄ

### –î–ª—è –∑–∞–ø—É—Å–∫–∞:

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
make build
make up

# 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î
make init-db

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ
make health
```

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã:
- Backend API: http://localhost:5000
- WebApp: http://localhost:3000
- Prometheus metrics: http://localhost:5000/metrics

### –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ:
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç race conditions
- ‚úÖ –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤
- ‚úÖ Rate limiting
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –¢–µ—Å—Ç—ã
- ‚úÖ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–Ω–æ–≤ –∏ –ª—É—Ç–±–æ–∫—Å–æ–≤

**–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã! –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É!** üéØ